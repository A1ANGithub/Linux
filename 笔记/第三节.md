 # 目录文件信息与位操作
 - i 节点不存储文件名。
 - stat 系统调用获取文件状态。将模式字段转换成字符
 - st_mode 是一个 16 位的二进制数，文件类型和权限被编码在这个数中。
   - 前 4 位用作文件类型，最多可以标识 16 种类型。接下来 3 位是文件的特殊属性，分别是 set-user-ID，set-group-ID，sticky 位。
   - 对可执行文件设置 setuid 权限时，将对运行该文件的进程授予基于文件所有者的访问权限。该访问权限不是基于正在运行可执行文件的用户。使用此特殊权限，用户可以访问通常只有属主才可访问的文件和目录。
    - setgid 权限与 setuid 权限类似。可将进程的有效组 ID 更改为拥有该文件的组，并基于授予该组的权限对用户授予访问权限。
   - sticky 位是保护目录中文件的权限位。如果对目录设置了 sticky 位，则只有文件所有者、目录所有者或特权用户才可以删除文件。root 用户是特权用户的一个示例。sticky 位禁止用户从公共目录（如 /tmp）中删除其他用户的文件，777 权限的文件需要对 sticky 置位，否则其他程序能轻易地删掉它。
   - 最后的 9 位是许可权限，分为 3 组，对应 3 组用户，分别是文件所有者、同组用户和其他用户。每组 3 位，分别是读、写和执行的权限。
 - 在开发中，函数不要超过 48 行以便于阅读和调试，较长的函数应该拆分。
 - 目录可读：可执行 ls 查看内容
 - 目录可写：在目录中添加或删除文件
 - 目录可执行：可执行cd命令打开目录
 - 掩码,掩码会将不需要的字段置 0，需要的字段的值不发生改变。
    ```
    运算	含义
    & mask	testing
    | mask	set
    & ~mask	reset
    ```

    ```
    <sys/stat.h> 中有以下定义：
    #define	S_IFMT	0170000	/* type of file */
    #define	S_IFREG	0100000	/* regular */
    #define S_IFDIR	0040000 /* directory */
    #define	S_IFBLK	0060000 /* block special */
    #define S_IFCHR	0020000 /* character special */
    #define S_IFIFO	0010000 /* fifo */
    #define S_IFLNK	0120000 /* symbolic link */
    #define S_IFSOCK 0140000 /* socket */
    ```
 - 文件相关的常用命令
     - chmod 命令
     - 修改文件权限。使用方法例如：
         - chmod g-w hello.c
         - chmod +w hello.c
         - chmod 640 hello.c
 - ln 命令
     - 在文件间创建链接，以系统调用 link 实现。
     - 硬链接不是快捷方式，而是同一文件的多个名称。
     - 当链接数为 0 时，i 节点被释放。
     - 删除到回收站只是移动。从回收站彻底删除时，i 节点被释放。
     - 软连接，类似于快捷方式
 - 其他命令
    ```
    命令	    含义
    chown	    改变某个文件或目录的所有者和所属的组
    mkdir	    创建目录
    rmdir	    删除目录
    rm	    系统调用 unlink
    mv	    系统调用 rename
    cd	    系统调用 chdir
    opendir	    打开目录
    readdir	    读取目录
    closedir    关闭目录
    ```
 - 硬链接与符号链接
     - 应当使用绝对路径，防止移动后失效。
     - 硬链接是将目录链接到树的指针，硬链接同时也是将文件名和文件本身链接起来的指针。 硬链接不能指向其他系统中的 i 节点，即使根也不能生成到目录的链接。
     - 符号链接通过名字引用文件，而不是 i 节点号，因而它可能跨越文件系统。
 - 设备，文件和连接控制
     - 设备就像文件
 - 在 Unix 系统中，每个设备都被当做一个文件。每个设备都有一个文件名、一个 i-节点号、一个文件所有者、一个权限位 的集合和最近修改时间。你所了解的和文件有关的所有内容都将被运用于终端和其他的设备。
 - Linux 将设备映射到 /dev/... 目录，例如：
     - /dev/sda 指向 SCSI ID 最小的 SCSI 硬盘
     - /dev/input/mice 指向鼠标设备文件的符号链接
 - 常用的磁盘文件由字节组成，磁盘文件中的字节数就是文件的大小。设备文件是链接，而不是容器。键盘和鼠标不存储击键数和点击数。设备文件的 i 节点存储的是指向内核子程序的指针，而不是文件的大小和存储列表。内核中传输设备数据的子程序被称为设备驱动程序。